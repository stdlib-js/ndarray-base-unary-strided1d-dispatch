// Copyright (c) 2025 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import t from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@v0.2.1-esm/index.mjs";import e from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-property@v0.2.2-esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-ndarray-like@v0.2.2-esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-object@v0.2.2-esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@v0.2.2-esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-collection@v0.2.2-esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-empty-collection@v0.2.2-esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function-array@v0.2.2-esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-data-type@v0.2.1-esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-output-data-type-policy@esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-contains@v0.2.2-esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-unary-strided1d@esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-unary-output-dtype@v0.2.2-esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-dtype-resolve-enum@v0.2.2-esm/index.mjs";import y from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-shape@v0.2.2-esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-ndims@v0.2.2-esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-dtype@v0.2.2-esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-order@v0.2.2-esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-empty@v0.3.0-esm/index.mjs";import g from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-zero-to@v0.2.1-esm/index.mjs";import b from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-join@v0.1.1-esm/index.mjs";import w from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-copy@v0.2.2-esm/index.mjs";import x from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-every-by@v0.2.2-esm/index.mjs";import _ from"https://cdn.jsdelivr.net/gh/stdlib-js/object-assign@v0.2.2-esm/index.mjs";import E from"https://cdn.jsdelivr.net/gh/stdlib-js/error-tools-fmtprodmsg@v0.2.2-esm/index.mjs";import T from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@v0.2.2-esm/index.mjs";import F from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@v0.2.2-esm/index.mjs";import{primitives as V}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-integer-array@v0.2.2-esm/index.mjs";import k from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-to-unique-normalized-indices@esm/index.mjs";var A={dims:null};function D(t,e,s,r){var i;if(!T(r))return new TypeError(E("null2V",r));if(F(r,"dims")){if(t.dims=r.dims,!V(t.dims)&&!d(t.dims))return new TypeError(E("invalid option. `%s` option must be an array of integers. Option: `%s`.","dims",t.dims));if(null===(i=k(t.dims,e-1)))return new RangeError(E("invalid option. `%s` option contains an out-of-bounds dimension index. Option: [%s].","dims",b(t.dims,",")));if(i.length!==t.dims.length)return new Error(E("invalid option. `%s` option contains duplicate indices. Option: [%s].","dims",b(t.dims,",")));t.dims=i}return F(r,"dtype")&&(t.dtype=r.dtype,!p(s,t.dtype))?new TypeError(E("null4S","dtype",b(s,'", "'),t.dtype)):null}function O(t,e,s,r,i,n,d,a,o){var m,p,l,h;for(m=n,l=0;l<t;l++){for(p=o,h=0;h<e&&s[m+h*i]===d[p];h++)p+=a;if(h===e)return l;m+=r}return-1}function S(t){var e,s;for(e=[],s=0;s<t.length;s++)e.push(u(t[s]));return e}function z(t,s,p,l){var h,u;if(!(this instanceof z))return new z(t,s,p,l);if(!r(t))throw new TypeError(E("null3L",t));if(!i(t.default))throw new TypeError(E('invalid argument. First argument must be an object having a "default" property and an associated method.'));if(e(t,"types")&&!n(t.types)&&!d(t.types))throw new TypeError(E('invalid argument. First argument must be an object having a "types" property whose associated value is an array-like object.'));if(e(t,"fcns")&&!a(t.fcns)&&!d(t.fcns))throw new TypeError(E('invalid argument. First argument must be an object having a "fcns" property whose associated value is an array-like object containing functions.'));if(!n(s))throw new TypeError(E("null2y",s));for(u=0;u<s.length;u++)if(h=s[u],!n(h)||h.length<1||!x(h,o))throw new TypeError(E("invalid argument. Second argument must contain arrays of data types. Value: `%s`.",s));if(!n(p)||p.length<1||!x(p,o))throw new TypeError(E("invalid argument. Third argument must be an array of data types. Value: `%s`.",p));if(!m(l))throw new TypeError(E("invalid argument. Fourth argument must be a supported output data type policy. Value: `%s`.",l));if(this._table={default:t.default,types:t.types?S(t.types):[],fcns:t.fcns?w(t.fcns):[]},this._table.types.length!==2*this._table.fcns.length)throw new Error("invalid argument. First argument specifies an unexpected number of types. A pair of input and output ndarray data types must be specified for each provided strided function.");return this._idtypes=s,this._odtypes=p,this._policy=l,this}t(z.prototype,"apply",(function(t){var e,r,i,n,d,a,o,m,f,w,x,T,F,V;if(i=arguments.length,!s(t))throw new TypeError(E("null5t",t));if(w=j(t),!p(this._idtypes[0],w))throw new TypeError(E('invalid argument. First argument must have one of the following data types: "%s". Data type: `%s`.',b(this._idtypes[0],'", "'),w));for(n=[t],V=1;V<i&&s(m=arguments[V]);V++){if(w=j(m),!p(this._idtypes[V],w))throw new TypeError(E('invalid argument. Argument %d must have one of the following data types: "%s". Data type: `%s`.',V,b(this._idtypes[V],'", "'),w));n.push(m)}if(V<i-1)throw new TypeError(E("invalid argument. Argument %d must be an ndarray-like object. Value: `%s`.",V,arguments[V]));if(T=(o=y(t)).length,d=_({},A),i>V&&(e=arguments[i-1],a=D(d,T,this._odtypes,e)))throw a;return null===d.dims&&(d.dims=g(T)),F=c(o,{dtype:d.dtype||h(w,this._policy),order:v(t)}),r=[u(w),u(j(F))],x=(f=O(this._table.fcns.length,2,this._table.types,2,1,0,r,1,0))>=0?this._table.fcns[f]:this._table.default,n.push(F),l(x,n,d.dims),F})),t(z.prototype,"assign",(function(t){var e,r,i,n,d,a,o,m,h,y,v,c,w,x;if(i=arguments.length,!s(t))throw new TypeError(E("null5t",t));if(v=j(t),!p(this._idtypes[0],v))throw new TypeError(E('invalid argument. First argument must have one of the following data types: "%s". Data type: `%s`.',b(this._idtypes[0],'", "'),v));for(d=[t],x=1;x<i&&s(a=arguments[x]);x++)d.push(a);if(x<2)throw new TypeError(E("invalid argument. Second argument must be an ndarray-like object. Value: `%s`.",arguments[1]));if(x===i-1)e=arguments[x],h=!0;else if(x<i-1)throw new TypeError(E("invalid argument. Argument %d must be an ndarray-like object. Value: `%s`.",x,arguments[x]));for(x=1;x<d.length-1;x++)if(v=j(d[x]),!p(this._idtypes[x],v))throw new TypeError(E('invalid argument. Argument %d must have one of the following data types: "%s". Data type: `%s`.',x,b(this._idtypes[x],'", "'),v));if(c=f(t),n=_({},A),h&&(o=D(n,c,this._odtypes,e)))throw o;return null===n.dims&&(n.dims=g(c)),m=d[1],d[1]=d[d.length-1],d[d.length-1]=m,r=[u(v),u(j(d[1]))],w=(y=O(this._table.fcns.length,2,this._table.types,2,1,0,r,1,0))>=0?this._table.fcns[y]:this._table.default,l(w,d,n.dims),d[1]}));export{z as default};
//# sourceMappingURL=index.mjs.map

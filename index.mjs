// Copyright (c) 2025 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import t from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@v0.2.1-esm/index.mjs";import e from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-property@v0.2.2-esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-ndarray-like@v0.2.2-esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-object@v0.2.2-esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@v0.2.2-esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-collection@v0.2.2-esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-empty-collection@v0.2.2-esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function-array@v0.2.2-esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-data-type@v0.2.1-esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-output-data-type-policy@esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-input-casting-policy@esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-contains@v0.2.2-esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-unary-strided1d@esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-unary-output-dtype@v0.2.2-esm/index.mjs";import y from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-unary-input-casting-dtype@esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-dtype-resolve-enum@v0.2.2-esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-shape@v0.2.2-esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-ndims@v0.2.2-esm/index.mjs";import g from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-dtype@v0.2.2-esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-order@v0.2.2-esm/index.mjs";import b from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assign@v0.1.1-esm/index.mjs";import w from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-empty@v0.3.0-esm/index.mjs";import x from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-empty@v0.3.0-esm/index.mjs";import _ from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-zero-to@v0.2.1-esm/index.mjs";import E from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-join@v0.1.1-esm/index.mjs";import T from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-copy@v0.2.2-esm/index.mjs";import F from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-every-by@v0.2.2-esm/index.mjs";import V from"https://cdn.jsdelivr.net/gh/stdlib-js/object-assign@v0.2.2-esm/index.mjs";import k from"https://cdn.jsdelivr.net/gh/stdlib-js/error-tools-fmtprodmsg@v0.2.2-esm/index.mjs";import A from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@v0.2.2-esm/index.mjs";import D from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@v0.2.2-esm/index.mjs";import{primitives as O}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-integer-array@v0.2.2-esm/index.mjs";import S from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-to-unique-normalized-indices@esm/index.mjs";var z={dims:null};function q(t,e,s,r){var i;if(!A(r))return new TypeError(k("null2V",r));if(D(r,"dims")){if(t.dims=r.dims,!O(t.dims)&&!a(t.dims))return new TypeError(k("invalid option. `%s` option must be an array of integers. Option: `%s`.","dims",t.dims));if(null===(i=S(t.dims,e-1)))return new RangeError(k("invalid option. `%s` option contains an out-of-bounds dimension index. Option: [%s].","dims",E(t.dims,",")));if(i.length!==t.dims.length)return new Error(k("invalid option. `%s` option contains duplicate indices. Option: [%s].","dims",E(t.dims,",")));t.dims=i}return D(r,"dtype")&&(t.dtype=r.dtype,!l(s,t.dtype))?new TypeError(k("null4S","dtype",E(s,'", "'),t.dtype)):null}function L(t,e,s,r,i,n,a,d,o){var m,p,l,h;for(m=n,l=0;l<t;l++){for(p=o,h=0;h<e&&s[m+h*i]===a[p];h++)p+=d;if(h===e)return l;m+=r}return-1}function R(t){var e,s;for(e=[],s=0;s<t.length;s++)e.push(f(t[s]));return e}function B(t,e){var s,r,i;for(s=[],r=0,i=0;r<=t.length;r++)1===r?s.push(e):(s.push(t[i]),i+=1);return s}function C(t,s,l,h){var u,y;if(!(this instanceof C))return new C(t,s,l,h);if(!r(t))throw new TypeError(k("null3L",t));if(!i(t.default))throw new TypeError(k('invalid argument. First argument must be an object having a "default" property and an associated method.'));if(e(t,"types")&&!n(t.types)&&!a(t.types))throw new TypeError(k('invalid argument. First argument must be an object having a "types" property whose associated value is an array-like object.'));if(e(t,"fcns")&&!d(t.fcns)&&!a(t.fcns))throw new TypeError(k('invalid argument. First argument must be an object having a "fcns" property whose associated value is an array-like object containing functions.'));if(!n(s))throw new TypeError(k("null2y",s));for(y=0;y<s.length;y++)if(u=s[y],!n(u)||u.length<1||!F(u,o))throw new TypeError(k("invalid argument. Second argument must contain arrays of data types. Value: `%s`.",s));if(!n(l)||l.length<1||!F(l,o))throw new TypeError(k("invalid argument. Third argument must be an array of data types. Value: `%s`.",l));if(!r(h))throw new TypeError(k("null43",t));if(!m(h.output))throw new TypeError(k("invalid argument. Fourth argument must be an object having a supported output data type policy. Value: `%s`.",h.output));if(!p(h.casting))throw new TypeError(k("invalid argument. Fourth argument must be an object having a supported casting policy. Value: `%s`.",h.casting));if(this._table={default:t.default,types:t.types?R(t.types):[],fcns:t.fcns?T(t.fcns):[]},this._table.types.length!==2*this._table.fcns.length)throw new Error("invalid argument. First argument specifies an unexpected number of types. A pair of input and output ndarray data types must be specified for each provided strided function.");return this._idtypes=s,this._odtypes=l,this._policies={output:h.output,casting:h.casting},this}t(C.prototype,"apply",(function(t){var e,r,i,n,a,d,o,m,p,c,T,F,A,D,O,S;if(i=arguments.length,!s(t))throw new TypeError(k("null5t",t));if(p=g(t),!l(this._idtypes[0],p))throw new TypeError(k('invalid argument. First argument must have one of the following data types: "%s". Data type: `%s`.',E(this._idtypes[0],'", "'),p));for(n=[t],S=1;S<i&&s(m=arguments[S]);S++){if(F=g(m),!l(this._idtypes[S],F))throw new TypeError(k('invalid argument. Argument %d must have one of the following data types: "%s". Data type: `%s`.',S,E(this._idtypes[S],'", "'),F));n.push(m)}if(S<i-1)throw new TypeError(k("invalid argument. Argument %d must be an ndarray-like object. Value: `%s`.",S,arguments[S]));if(D=(o=j(t)).length,a=V({},z),i>S&&(e=arguments[i-1],d=q(a,D,this._odtypes,e)))throw d;return null===a.dims&&(a.dims=_(D)),c=a.dtype||u(p,this._policies.output),O=x(o,{dtype:c,order:v(t)}),p!==(F=y(p,c,this._policies.casting))&&(T=w(F,o,v(t)),b([t,T]),n[0]=T,p=F),r=[f(p),f(c)],A=(S=L(this._table.fcns.length,2,this._table.types,2,1,0,r,1,0))>=0?this._table.fcns[S]:this._table.default,h(A,B(n,O),a.dims),O})),t(C.prototype,"assign",(function t(e){var r,i,n,a,d,o,m,p,u,b,x,T,F,A,D;if(n=arguments.length,!s(e))throw new TypeError(k("null5t",e));if(u=g(e),!l(this._idtypes[0],u))throw new TypeError(k('invalid argument. First argument must have one of the following data types: "%s". Data type: `%s`.',E(this._idtypes[0],'", "'),u));for(d=[e],D=1;D<n&&s(o=arguments[D]);D++)d.push(o);if(D<2)throw new TypeError(k("invalid argument. Second argument must be an ndarray-like object. Value: `%s`.",arguments[1]));if(D===n-1)r=arguments[D],p=!0;else if(D<n-1)throw new TypeError(k("invalid argument. Argument %d must be an ndarray-like object. Value: `%s`.",D,arguments[D]));for(A=d.pop(),D=1;D<d.length;D++)if(x=g(d[D]),!l(this._idtypes[D],x))throw new TypeError(k('invalid argument. Argument %d must have one of the following data types: "%s". Data type: `%s`.',D,E(this._idtypes[D],'", "'),x));if(T=c(e),a=V({},z),p&&(m=q(a,T,this._odtypes,r)))throw m;return null===a.dims&&(a.dims=_(T)),u!==(x=y(u,g(A),this._policies.casting))&&(t([e,b=w(x,j(e),v(e))]),d[0]=b,u=x),i=[f(x),f(g(A))],F=(D=L(this._table.fcns.length,2,this._table.types,2,1,0,i,1,0))>=0?this._table.fcns[D]:this._table.default,h(F,B(d,A),a.dims),A}));export{C as default};
//# sourceMappingURL=index.mjs.map
